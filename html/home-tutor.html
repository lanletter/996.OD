<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <!-- 这是个iphone设备中的safari私有meta标签，它表示：允许全屏模式浏览；-->
    <meta content="yes" name="apple-mobile-web-app-capable">
    <!-- 全屏显示-->
    <meta name="apple-touch-fullscreen" content="yes">
    <!-- 不要让设备识别电话号码和邮箱地址-->
    <meta content="telephone=no,email=no" name="format-detection">
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" id="viewport"
          name="viewport">
    <!-- DNS预解析-->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    <meta http-equiv="imagetoolbar" content="false">
    <!--<script src="../js/tingyun-rum.js"></script>-->
    <link href="../css/common.css?ver=420" rel="stylesheet">
    <link href="../css/home-user.css?ver=420" rel="stylesheet">
    <title>用户主页</title>
    <script type='text/javascript'>
        !function (e, t, n, g, i) {
            e[i] = e[i] || function () {
                (e[i].q = e[i].q || []).push(arguments)
            }, n = t.createElement("script"), tag = t.getElementsByTagName("script")[0], n.async = 1, n.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + g, tag.parentNode.insertBefore(n, tag)
        }(window, document, "script", "assets.growingio.com/2.1/gio.js", "gio");
        gio('init', '80624a28abff7348', {});
    </script>
</head>
<body>
<div class="personinfo">
    <header>
        <img class="headimg" :src="data.picture.path">
        <div class="headinfo">
            <span class="nickname">Jakbob</span>
            <p>
                <span class="sex">男</span>
                <span class="age">90后</span>
            </p>
            <p><span class="time">2018-4-5</span>加入方太生活家</p>
        </div>
    </header>

    <!--<div class="empty" v-if="data.list.length == 0">-->
        <!--<img src="../img/empty.png">-->
        <!--<p>该用户什么都没有留下</p>-->
    <!--</div>-->

    <p class="bigtitle">
        <span>菜谱</span>
        <a class="deeplikopen">全部</a>
    </p>
    <ul class="courseul">
        <li v-for="item in data.products" @click="jump(item.curriculum.id)">
            <div class="img" :style="{backgroundImage: 'url(' +item.curriculum.picture.path+ ')'}"></div>
            <img class="tutorimg" :src="item.curriculum.picture.path">
            <p class="tutorname">
                <span class="txtgrey2">
                    <b>主讲人：</b>
                    <b v-text="item.curriculum.cityName"></b>
                </span>
            </p>
            <h3 v-text="item.curriculum.curriculumName">韩式经典料理韩式经典料理韩式经典料理韩式</h3>
            <span class="price"><b v-text="item.curriculum.price">300</b>.00</span>
            <p class="underline">
                <span class="txtgrey2">{{format2(item.curriculum.startTime)}}</span>
                &nbsp;&nbsp;
                <span class="txtgrey2">{{item.curriculum.store.storeName}}</span>
            </p>
        </li>
    </ul>
</div>

<div class="footer" style="display: none;">
    <img src="../img/logo_gold2.png">
    <p>
        <span>方太生活家</span>
        <span>分享生活味道</span>
    </p>
    <span id="jump" class="deeplikopen">打开</span>
    <span id="download">下载</span>
</div>

<script type="text/javascript" src='../js/lib.js'></script>
<script type="text/javascript" src='../js/api.js'></script>
<script src="../js/vue.min.js"></script>
<script src="../js/vue-resource1.3.4.js"></script>
<script type="text/javascript" src='../js/ft.js'></script>
<script type="text/javascript" src='../js/jquery.cookie.js'></script>
<script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script src="../js/BigPictureOpen.js"></script>
<script src="../js/url.js"></script>
<script type="text/javascript" src="../js/UMAnalytics.js"></script>
<!--<script type="text/javascript" src="../js/ajaxsetup.js"></script>-->

<link href="../css/hls/video-js.css" rel="stylesheet">
<script src="../js/hls/video.js"></script>
<script type="text/javascript" src='../js/deeplink.js'></script>
<script>
    /*获取url*/
    function GetQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]);
        return null;
    }

    var id = GetQueryString("id");
    var device = GetQueryString("device");
    if (device == null || device == "null") {
        $(".footer").show();
    } else {
        $(".footer").hide();
    }

    var vm = new Vue({
        el: '.personinfo',
        data: {
            data: {},
            dataask: {},
            datalist: {},
            dataother: {}
        },
        created: function () {
            var $this = this;
            $.ajax({
                url: urlport + 'special/detail',
                type: 'POST',
                data: JSON.stringify({"id": id}),
                timeout: 5000, //超时时间
                contentType: "application/json;charset=utf-8",
                dataType: 'json', //返回的数据格式
                success: function (data) {
                    console.log(data);
                    callback(data);
                },
                error: function (errorMsg) {
                    console.log('错误');
                    console.log(errorMsg);
                }
            });
            function callback(res) {
                var data = res;
                // console.log(data);
                if (data.status == 200) {
                    $this.data = data.data;
                    id = $this.data.id;
                    console.log($this.data);
                }
                document.setTitle = function (t) {
                    document.title = t;
                    var i = document.createElement('iframe');
                    i.style.display = 'none';
                    i.onload = function () {
                        setTimeout(function () {
                            i.remove();
                        })
                    };
                    document.body.appendChild(i);
                };
                setTimeout(function () {
                    document.setTitle($this.data.title);
                });
                /*分享链接专用*/
                var sharetitle = $this.data.title;
                var sharedesc = $this.data.desc;
                var shareimg = $this.data.picture;
                var sharestr = $this.data.url;
                var sharelink = $this.data.url;
                /*微信分享专用*/
                $.ajax({
                    type: 'GET',
                    url: urlport + 'wx/wxConfig.json?url=' + encodeURIComponent(window.location.href.split('#')[0]),
                    success: function (data) {
                        // console.info(data.appId);
                        wx.config({
                            debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                            appId: data.appId, // 必填，公众号的唯一标识
                            timestamp: data.timestamp, // 必填，生成签名的时间戳
                            nonceStr: data.nonceStr, // 必填，生成签名的随机串
                            signature: data.signature,
                            jsApiList: [
                                "onMenuShareTimeline",
                                "onMenuShareAppMessage",
                                "onMenuShareQQ",
                                "onMenuShareWeibo",
                                "onMenuShareQZone"
                            ]
                        });
                        wx.ready(function () {
                            //分享给朋友圈
                            wx.onMenuShareTimeline({
                                title: sharetitle, // 分享标题
                                link: sharelink, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
                                imgUrl: shareimg, // 分享图标
                                success: function () {
                                    // 用户确认分享后执行的回调函数
                                },
                                cancel: function () {
                                    // 用户取消分享后执行的回调函数
                                }
                            });
                            //分享给朋友
                            wx.onMenuShareAppMessage({
                                title: sharetitle, // 分享标题
                                desc: sharedesc, // 分享描述
                                link: sharelink, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
                                imgUrl: shareimg, // 分享图标
                                type: '', // 分享类型,music、video或link，不填默认为link
                                dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
                                success: function () {
                                    // 用户确认分享后执行的回调函数
                                },
                                cancel: function () {
                                    // 用户取消分享后执行的回调函数
                                }
                            });
                        });
                    },
                    error: function (xhr, type) {
                        //alert(111);
                    }
                })
            }

        },
        methods: {
            addnum: function (m) {
                return m < 10 ? '0' + m : m
            },
            format: function (starttime, endtime) {
                var $this = this;
                var time1 = new Date(starttime);
                var month1 = time1.getMonth() + 1;
                var date1 = time1.getDate();
                var hour1 = time1.getHours();
                var minute1 = time1.getMinutes();
                var time2 = new Date(endtime);
                var month2 = time2.getMonth() + 1;
                var date2 = time2.getDate();
                var hour2 = time2.getHours();
                var minute2 = time2.getMinutes();
                if (month1 == month2 && date1 == date2) {
                    return $this.addnum(month1) + '月' + $this.addnum(date1) + '日' + '  ' + $this.addnum(hour1) + ':' + $this.addnum(minute1)
                        + '-' + $this.addnum(hour2) + ':' + $this.addnum(minute2);
                } else {
                    return $this.addnum(month1) + '月' + $this.addnum(date1) + '日' + '  ' + $this.addnum(hour1) + ':' + $this.addnum(minute1)
                        + '-' + $this.addnum(month2) + '月' + $this.addnum(date2) + '日' + $this.addnum(hour2) + ':' + $this.addnum(minute2);
                }
            },
            format2: function (starttime) {
                var $this = this;
                var time = new Date(starttime);
                var year = time.getFullYear();
                var month = time.getMonth() + 1;
                var date = time.getDate();
                var hour = time.getHours();
                var minute = time.getMinutes();
                return year + '年' + $this.addnum(month) + '月' + $this.addnum(date) + '日' + $this.addnum(hour) + ':' + $this.addnum(minute);
            },
            jump: function (id) {
//                 curriculumurl = "https://h5.fotilestyle.com/html/coursedetail.html?id=" + id + "&device=" + device + "&jump=jump";
                curriculumurl = "http://h5.fotilestyle.com/fotilestyle-test/html/coursedetail.html?id=" + id + "&device=" + device + "&jump=jump";
                window.location.href = curriculumurl;
            }

        }
    });


</script>


</body>
</html>